<?xml version="1.0" encoding="UTF-8"?>

<beans:beans xmlns:beans="http://www.springframework.org/schema/beans"
    xmlns="http://www.springframework.org/schema/security"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.springframework.org/schema/beans 
        http://www.springframework.org/schema/beans/spring-beans-4.0.xsd
        http://www.springframework.org/schema/security 
        http://www.springframework.org/schema/security/spring-security-3.2.xsd">

    <http auto-config="true" use-expressions="true">
        <intercept-url pattern="/**" access="hasRole('ROLE_BASIC')"/>
    </http>

    <authentication-manager alias="authenticationManager">
            <authentication-provider user-service-ref="userService" />
    </authentication-manager>

    <user-service id="userService">
        <user name="nicolas" password="123" authorities="ROLE_BASIC,ROLE_ADMIN"/>
        <user name="john" password="123"  authorities="ROLE_BASIC"/>
        <user name="admin" password="admin" authorities="ROLE_ADMIN"/>
    </user-service>


    <!--
                BIG SAMPLE FROM spring in action
    Automatically registers a login form, BASIC authentication, anonymous authentication, 
    logout services, remember-me and servlet-api-integration.
  -->
  <!--<http auto-config="true" use-expressions="true">-->
    <!--<form-login login-page="/login"-->
                <!--login-processing-url="/static/j_spring_security_check"  -->
                <!--authentication-failure-url="/login"/>-->
    <!--<logout logout-url="/static/j_spring_security_logout"/>-->
    <!--<intercept-url pattern="/favicon.ico" access="permitAll" />-->
    <!--<intercept-url pattern="/home" access="hasRole('ROLE_SPITTER')"/>-->
    <!--<intercept-url pattern="/admin/**" -->
        <!--access="isAuthenticated() and principal.username=='habuma'"/>-->
    <!--<intercept-url pattern="/login" requires-channel="https"/>-->
    <!--<intercept-url pattern="/spitter/form" requires-channel="https"/>-->

    <!--<remember-me key="spitterKey" token-validity-seconds="2419200" />-->
        <!---->
  <!--</http>-->

<!--&lt;!&ndash;<start id="authentication_manager"/>&ndash;&gt;-->
  <!--<authentication-manager alias="authenticationManager">-->
    <!--<authentication-provider user-service-ref="userService" />-->
  <!--</authentication-manager>-->
<!--&lt;!&ndash;<end id="authentication_manager"/>&ndash;&gt;-->

  <!--&lt;!&ndash; ...or spitter-security-ldap.xml, or spitter-security-inmemory.xml &ndash;&gt;-->
  <!--<beans:import resource="spitter-security-ldap.xml"/>-->

<!--&lt;!&ndash;<start id="globalMethodSecurity_securedAnnotations"/>&ndash;&gt; -->
  <!--<global-method-security secured-annotations="enabled" /> -->
<!--&lt;!&ndash;<end id="globalMethodSecurity_securedAnnotations"/>&ndash;&gt; -->
</beans:beans>
